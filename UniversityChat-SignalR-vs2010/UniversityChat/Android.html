<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>University Chat web-sockets Android interface</title>
    <script src="Scripts/jquery-1.6.4.min.js"></script>
    <script src="Scripts/jquery.signalR-1.0.0-rc2.js"></script>
    <script src="/signalr/hubs"></script>   <!-- auto-generated by SignalR -->
</head>
<body>
    <p>Android interface</p>

    <script type="text/javascript">
        var chat = $.connection.chatHub;
        
        // received a chat message from server.
        chat.client.broadcastMessageToChat = function (name, message) {
            appendMessage(name + ": " + message);
        };

        // received the user list from server.
        chat.client.setUserList = function (userlist) {
            Android.setChannelUsers(userlist);
        };

        function appendMessage(message) {
            Android.appendMessage(message);
        }

        function sendMessage(name, message) {
            chat.server.send(name, message);
        }

        function joinChat(userName) {
            $.connection.hub.start().done(function () {
                chat.server.newUser(userName);
                Android.joinChatComplete();
            });
        }

        function disconnect() {
            $.connection.stop();
        }

        Android.pageLoadComplete();
    </script>
</body>
</html>
